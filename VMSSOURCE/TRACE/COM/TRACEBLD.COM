$ !
$ !	[ T R A C E . C O M ] T R A C E B L D . C O M
$ !
$ !	ASSUMES [TRACE.COM] AND DEFINITIONS FOR LIB$:, LIS$:, SRC$:,
$ !			MAP$:, EXE$:, EXECML$, OBJ$: AND COM$:.
$ !
$ GOTO 'PHASE'
$
$INIT:
$ !
$ !	CREATE THE DIRECTORIES
$ !
$ @SYSBLDCOM$:CREATEDIR
$ EXIT
$
$UPDATE:
$ !
$ !	Create updated require file sources.
$ !
$ @COM$:TRACEUPD
$ EXIT
$
$SRCLIB:
$ !
$ ! Build the Traceback message require files.
$ !
$ DELETE LIB$:TRACEMSG.MAR;*,TRACEMSG.REQ;*
$ MCR MDL LIB$:TRACEMSG=SRC$:TRACEMSG.MDL
$ RENAME LIB$:TRACEMSG.B32 LIB$:TRACEMSG.REQ
$ !
$ ! Re-create the BLISS libraries
$ !
$ BLISS/LIBRARY=LIB$:STRUCDEF.L32/LIST=LIS$:STRUCDEF.LIS SRC$:STRUCDEF.REQ
$ BLISS/LIBRARY=LIB$:TBKDST.L32/LIST=LIS$:TBKDST.LIS SRC$:TBKDST.REQ
$ BLISS/LIBRARY=LIB$:TBKLIB.L32/LIST=LIS$:TBKLIB.LIS SRC$:TBKLIB.REQ
$ EXIT
$
$ASSEM:
$ !
$ !	PURGE AND RE-CREATE THE ASSEMBLY LANGUAGE OBJECTS AND LISTINGS
$ !
$ PURGE OBJ$:*.OBJ,*.OBB,LIS$:*.LIS
$ @COM$:TBKMSGBLD
$ @SYSBLDCOM$:FASM 'FACNAM "" N 'UPDATES
$ CPYSYSMSG OBJ$:TRACEMSG.OBB
$ EXIT
$
$OBJLIB:
$ !
$ !	Create object library from object modules.
$ !
$ @SYSBLDCOM$:OBJLIB TRACE
$ EXIT
$
$LNKLIB:
$ !
$ ! Null LNKLIB phase
$ !
$ EXIT
$
$LINK:
$ !
$ !	DELETE IMAGE AND MAP FOR TRACE, THEN RE-CREATE PUTTING THE IMAGE
$ !	ON EXE$: AND THE MAP ON MAP$:.
$ !
$ DELETE EXE$:TRACE.EXE;*
$ DELETE MAP$:TRACE.MAP;*
$ @COM$:TRACELNK
$ EXIT
$
$RESULT:
$ !
$ !	COPY THE IMAGE AND MAP TO A SYSTEM AREA.
$ !
$ CPYSYSLIB EXE$:TRACE.EXE
$ CPYRESMAP MAP$:TRACE.MAP
$ !
$ !	BUILD THE CONCATENATED LISTING RESLIS$:TRACE.LSS
$ !
$ CPYRESLIS LIS$:*.LIS TRACE.LSS
